language: node_js

env:
  global:
    - CXX=g++-4.8
    - secure: CdBNOl0sFTumjyDQqE3Kz/l9h0Oqwz5VajBnxD4JxYZhVsd6iJ/qoPzte0ogsUYKtC9eHCa45vAZJ+IFtxe7oHFUxn4YNjoNuv2u9+ZmNvJDMY5do5KNoT7v+lBMq7BCXOCrwtNo0emGBW7OZ6fcWhc8clb+t/ixo6ADJN7M0yzm1JuopKM0NDB8HhwDcuiTcZrlPD9aPSfQf/0mUVNQfg204WsAzaUAlIn8qViGlVFDAR3qoBi1kH9AhHF3SAkNQ9wzoGAA/0m3AOAw90LLvRycjGkLbJTVuLGLzXjHwW4DkCj+KsFj90uoEnIrzZhv5IUhrpgpT20SgObg/B5oL7ZEawLIgW3aopqxEE/JRyBj686O4BYRyjIL77Kqhs+qOKWknpgPeJ+2PATACAuN2eriGiO3kB3ZdlkbtwHZq5935MyWPiIQCNVZ5gYq4QfsCHiRdXrNzJChuede8KWLr/rTvWB530tgiPS9NW2WJUwclPucD1oNqdeWkaRSnCV6VC6dJmeDPnCKvSxAz1HeAIaleeAqGG2+0fo9QOaLfKuBBvNs0S1Rur7d1ZcrbaAVgy3oW0a/UNeEJ2m/HAHU8ofAulIuP5tlEB5tNDLtuSVvPVY+vAbcmkqAvrFjbKcuARPBCvMk3YhibuE3uxC+gDBLc7Ok6JHFdEu3KESvjv8=

node_js:
- '4'
- '6'
- '8'

addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    packages:
    - g++-4.8
    
sudo: false

before_install:
- $CXX --version

before_script:
- COMMIT_MESSAGE=$(git show -s --format=%B $TRAVIS_COMMIT | tr -d '\n')

script:
- if [[ ${COMMIT_MESSAGE} =~ "[publish binary]" ]]; then node-pre-gyp package && node-pre-gyp-github publish; fi;